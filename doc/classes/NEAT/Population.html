<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>NEAT::Population</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../css/github.css" type="text/css" media="screen" />
<script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>

</head>

<body>     
    <div class="banner">
        
        <h1>
            <span class="type">Class</span> 
            NEAT::Population 
            
                <span class="parent">&lt; 
                    
                    NeatOb
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/rubyneat/population_rb.html">rubyneat/population.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<h1 id="label-Population+of+NEAT+Critters."><a href="Population.html">Population</a> of <a href="../NEAT.html">NEAT</a> Critters.</h1>

<pre>The Population 
In ourselves we have the pool of neurons the critters all use.
the pool of neurons are indirects, of course, as during phenotype
expression, all the phenotypes shall be created individually.</pre>

    </div>
  


  


  
  


  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>A</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-analyze-21">analyze!</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>E</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-evaluate-21">evaluate!</a>,
              </li>
            
              
              <li>
                <a href="#method-i-evolve">evolve</a>,
              </li>
            
              
              <li>
                <a href="#method-i-express-21">express!</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>N</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-new">new</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>S</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-speciate-21">speciate!</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  



  

    

    

    


    
      <!-- Section attributes -->
      <div class="sectiontitle">Attributes</div>
      <table border='0' cellpadding='5'>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>critters</td>
            <td class='attr-desc'><p>list of critter in this population</p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>fitness</td>
            <td class='attr-desc'><p>Overall population fitness and novelty</p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>hidden_neurons</td>
            <td class='attr-desc'><p>List of possible neuron classes for hidden neurons.</p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>input_neurons</td>
            <td class='attr-desc'><p>Ordered list or hash of input neuron classes (all critters generated here
shall have this)</p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>novelty</td>
            <td class='attr-desc'><p>Overall population fitness and novelty</p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>output_neurons</td>
            <td class='attr-desc'><p>Ordered list or hash of output neuron classes (all critters generated here
shall have this)</p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>species</td>
            <td class='attr-desc'><p>Hash list of species lists</p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>traits</td>
            <td class='attr-desc'></td>
          </tr>
        
      </table>
    


    <!-- Methods -->
    
      <div class="sectiontitle">Class Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-c-new">
            
              <b>new</b>(c)
            
            <a href="../../classes/NEAT/Population.html#method-c-new" name="method-c-new" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>Create initial (ramdom) population of critters</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-new_source')" id="l_method-c-new_source">show</a>
                
              </p>
              <div id="method-c-new_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rubyneat/population.rb, line 32</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">initialize</span>(<span class="ruby-identifier">c</span>)
  <span class="ruby-keyword">super</span>
  <span class="ruby-ivar">@input_neurons</span> = <span class="ruby-identifier">c</span>.<span class="ruby-identifier">neural_inputs</span>.<span class="ruby-identifier">clone</span>
  <span class="ruby-ivar">@output_neurons</span> = <span class="ruby-identifier">c</span>.<span class="ruby-identifier">neural_outputs</span>.<span class="ruby-identifier">clone</span>
  <span class="ruby-ivar">@hidden_neurons</span> = <span class="ruby-keyword">unless</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">neural_hidden</span>.<span class="ruby-identifier">nil?</span>
                      <span class="ruby-identifier">c</span>.<span class="ruby-identifier">neural_hidden</span>
                    <span class="ruby-keyword">else</span>
                      <span class="ruby-identifier">c</span>.<span class="ruby-identifier">neuron_catalog</span>.<span class="ruby-identifier">keep_if</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">n</span><span class="ruby-operator">|</span> <span class="ruby-keyword">not</span> <span class="ruby-identifier">n</span>.<span class="ruby-identifier">input?</span>}
                    <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@critters</span> = (<span class="ruby-number">0</span> <span class="ruby-operator">...</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">parms</span>.<span class="ruby-identifier">start_population_size</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">parms</span>.<span class="ruby-identifier">population_size</span>).<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span>
    <span class="ruby-constant">Critter</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">self</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                  
      <div class="sectiontitle">Instance Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-i-analyze-21">
            
              <b>analyze!</b>()
            
            <a href="../../classes/NEAT/Population.html#method-i-analyze-21" name="method-i-analyze-21" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>Alalyze evaluation results.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-analyze-21_source')" id="l_method-i-analyze-21_source">show</a>
                
              </p>
              <div id="method-i-analyze-21_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rubyneat/population.rb, line 57</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">analyze!</span>
   <span class="ruby-ivar">@critters</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">critter</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@controller</span>.<span class="ruby-identifier">evaluator</span>.<span class="ruby-identifier">analyze_for_fitness!</span> <span class="ruby-identifier">critter</span> }
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-evaluate-21">
            
              <b>evaluate!</b>()
            
            <a href="../../classes/NEAT/Population.html#method-i-evaluate-21" name="method-i-evaluate-21" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>Called for each sequence.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-evaluate-21_source')" id="l_method-i-evaluate-21_source">show</a>
                
              </p>
              <div id="method-i-evaluate-21_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rubyneat/population.rb, line 52</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">evaluate!</span>
   <span class="ruby-ivar">@critters</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">critter</span><span class="ruby-operator">|</span> <span class="ruby-identifier">critter</span>.<span class="ruby-identifier">evaluate!</span> }
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-evolve">
            
              <b>evolve</b>()
            
            <a href="../../classes/NEAT/Population.html#method-i-evolve" name="method-i-evolve" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>Call this after evaluation. Returns a newly-evolved population.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-evolve_source')" id="l_method-i-evolve_source">show</a>
                
              </p>
              <div id="method-i-evolve_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rubyneat/population.rb, line 63</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">evolve</span>
  <span class="ruby-ivar">@controller</span>.<span class="ruby-identifier">evolver</span>.<span class="ruby-identifier">evolve</span> <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-express-21">
            
              <b>express!</b>()
            
            <a href="../../classes/NEAT/Population.html#method-i-express-21" name="method-i-express-21" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>Express the entire population.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-express-21_source')" id="l_method-i-express-21_source">show</a>
                
              </p>
              <div id="method-i-express-21_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rubyneat/population.rb, line 47</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">express!</span>
   <span class="ruby-ivar">@critters</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">critter</span><span class="ruby-operator">|</span> <span class="ruby-identifier">critter</span>.<span class="ruby-identifier">express!</span> }
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-speciate-21">
            
              <b>speciate!</b>()
            
            <a href="../../classes/NEAT/Population.html#method-i-speciate-21" name="method-i-speciate-21" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <pre>Group crtters into species
Note that the @species objects
have useful singleton methods:</pre>
<ul><li>
<p>@species.member? – checks all of the lists for membership, not just the
hash</p>
</li><li>
<p>@<a href="http://crit">species</a>.fitness – fitness of the entire species</p>
</li></ul>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-speciate-21_source')" id="l_method-i-speciate-21_source">show</a>
                
              </p>
              <div id="method-i-speciate-21_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rubyneat/population.rb, line 72</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">speciate!</span>
  <span class="ruby-comment"># We blow away existing species and create our own member? function</span>
  <span class="ruby-ivar">@species</span> = {} <span class="ruby-comment"># lists keyed by representative critter</span>
  <span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">@species</span>.<span class="ruby-identifier">member?</span>(<span class="ruby-identifier">crit</span>)
    <span class="ruby-keyword">super</span>.<span class="ruby-identifier">member?</span>(<span class="ruby-identifier">crit</span>) <span class="ruby-keyword">or</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">li</span><span class="ruby-operator">|</span> <span class="ruby-identifier">li</span>.<span class="ruby-identifier">member?</span> <span class="ruby-identifier">crit</span>}.<span class="ruby-identifier">reduce</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">t1</span>, <span class="ruby-identifier">t2</span><span class="ruby-operator">|</span> <span class="ruby-identifier">t1</span> <span class="ruby-keyword">or</span> <span class="ruby-identifier">t2</span> }
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">@species</span>.<span class="ruby-identifier">evaluate!</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">sp</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">sp</span>.<span class="ruby-identifier">fitness</span> = <span class="ruby-identifier">sp</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">crit</span><span class="ruby-operator">|</span> <span class="ruby-identifier">crit</span>.<span class="ruby-identifier">fitness</span>}.<span class="ruby-identifier">reduce</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">a</span>,<span class="ruby-identifier">b</span><span class="ruby-operator">|</span> <span class="ruby-identifier">a</span><span class="ruby-operator">+</span><span class="ruby-identifier">b</span>} <span class="ruby-operator">/</span> <span class="ruby-identifier">sp</span>.<span class="ruby-identifier">size</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  
  <span class="ruby-comment"># Some convience parms</span>
  <span class="ruby-identifier">threshold</span> = <span class="ruby-ivar">@controller</span>.<span class="ruby-identifier">parms</span>.<span class="ruby-identifier">compatibility_threshold</span>

  <span class="ruby-comment"># And so now we iterate...</span>
  <span class="ruby-ivar">@critters</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">crit</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">wearein</span> = <span class="ruby-keyword">false</span>
    <span class="ruby-ivar">@species</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ck</span>, <span class="ruby-identifier">list</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">delta</span> = <span class="ruby-identifier">crit</span>.<span class="ruby-identifier">compare</span>(<span class="ruby-identifier">ck</span>)
      <span class="ruby-identifier">log</span>.<span class="ruby-identifier">debug</span> { <span class="ruby-node">&quot;delta for #{crit} and #{ck} is #{delta}&quot;</span> }
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">delta</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">threshold</span>
        <span class="ruby-identifier">list</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">crit</span>
        <span class="ruby-identifier">wearein</span> = <span class="ruby-keyword">true</span>
        <span class="ruby-keyword">break</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-comment"># New species?</span>
    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">wearein</span>
      <span class="ruby-ivar">@species</span>[<span class="ruby-identifier">crit</span>] = <span class="ruby-identifier">species</span> = [<span class="ruby-identifier">crit</span>]
      <span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">species</span>.<span class="ruby-identifier">fitness=</span>(<span class="ruby-identifier">fit</span>)
        <span class="ruby-ivar">@fitness</span> = <span class="ruby-identifier">fit</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">species</span>.<span class="ruby-identifier">fitness</span>
        <span class="ruby-ivar">@fitness</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># And now we evaluate all species for fitness...</span>
  <span class="ruby-ivar">@species</span>.<span class="ruby-identifier">evaluate!</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                    </div>

    </div>
  </body>
</html>    